\documentclass[10pt, a4paper, nottitlepage]{article}

% Include packages 
\usepackage[left=2.5cm,right=2.5cm,top=2.5cm,bottom=2.5cm]{geometry}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[english]{babel}

\usepackage{float}
\usepackage{gensymb}
\usepackage{xcolor}
\usepackage{tikz}
\usepackage{graphicx}
\usepackage{lmodern}
\usepackage{amsmath,amsfonts,amssymb}
\usepackage{mathtools}
\usepackage{booktabs}
\usepackage{fancyhdr}
\usepackage{pdfpages}
\usepackage{extarrows}
\usepackage{subcaption}
\usepackage{url}
\usepackage{hyperref}
\usepackage{fontawesome}
\usepackage{marvosym}
\usepackage{acronym}
\usepackage{enumitem}
\usepackage{pdflscape}
\usepackage{listings}
\usepackage{siunitx}
%\usepackage{icomma}
\usepackage{bigdelim}
\usepackage{isotope}
\setlength{\parindent}{0em} 
\newcommand{\IU}{\mathrm{i}} 

\renewcommand{\lstlistingname}{Python-Code}
\lstset{
	language=Python,
	frame=single,
	morekeywords={as,True,False},
	basicstyle=\footnotesize,
	keywordstyle=\color{blue}\bfseries,
	commentstyle=\color{red},
	stringstyle=\color{red},
	showstringspaces=false,
	showspaces=false,
	numbers=left,
	extendedchars=true,
	literate={ö}{{\"o}}1 {Ö}{{\"O}}1 {ä}{{\"a}}1 {Ä}{{\"A}}1 {ü}{{\"u}}1 {Ü}{{\"U}}1 {ß}{{\ss}}1}

\title{Introduction to Computational Physics  -- Exercise 9}
\author{Simon Groß-Bölting, Lorenz Vogel, Sebastian Willenberg}
\date{June 26, 2020}

\lstset{language=Python}
% The beginning of the document...
\begin{document}
\maketitle
\section*{The Lorenz Attractor}
The Lorenz attractor problem is given by the following coupled set of differential equations:
\begin{align}
	\dot{x} &= -\sigma(x-y) \\
	\dot{y} &= rx-y-xz \\
	\dot{z} &= xy-bz
\end{align}
As discussed in the lecture, the fixed points are $(0\,,\,0\,,\,0)$ for all $r$, and (for $r>1$) the points $C_{\pm}=(\pm a_0\,,\,\pm a_0\,,\,r-1)$ with $a_0=\sqrt{b(r-1)}$. For the entire exercise, please use $\sigma=10$ and $b=8/3$. The value of $r$ can be experimented with. When you create numerical solutions you can make plots in 2-D projection (e.g. in the $(x,y)$- or $(x,z)$-plane). You can also try a full 3-D plot.
\begin{description}
	\item[Task:] Solve numerically, using \texttt{rk4}, the above coupled set of equations for the values $r=0.5$, $1.17$, $1.3456$, $25.0$ and $29.0$. Choose the initial conditions near one of the fixed points: $C_{\pm}$ for $r>1$ and $(0\,,\,0\,,\,0)$ for $r<1$. Explain the behavior, as much as possible, with the stability properties of the fixed points.
\end{description}

To solve the problem numerically we can use the Runge-Kutta Algorithm to approximate the functions $x$, $y$ and $z$. It is important to note that $x(t)$, $y(t)$ and $z(t)$ are time-dependent.
We will start by importing the packages that we will need for this exercise:
\lstinputlisting[linerange={8-9}]{Homework09_Lorenz-Attractor_Gross-Boelting_Vogel_Willenberg.py}

The \texttt{numpy} package allows us to work with arrays while the \texttt{matplotpib.pyplot} and \texttt{mplot3d} packages will allow us to plot our data in a three-dimensional graph.
The next step is to define our parameters:  
\lstinputlisting[linerange={63-67}]{Homework09_Lorenz-Attractor_Gross-Boelting_Vogel_Willenberg.py}

The coupled set of differential equations are defined in the following manner:
\lstinputlisting[linerange={69-75}]{Homework09_Lorenz-Attractor_Gross-Boelting_Vogel_Willenberg.py}

All the differential equations in our Lorenz system are dependent of the functions \texttt{x}, \texttt{y} and \texttt{z} and a variable $\sigma$, $r$ or $b$. That means that we have to rewrite our \texttt{rk4} algorithm in such a way that we will iterate over \texttt{x}, \texttt{y} and \texttt{z} instead of iterating over \texttt{y} and \texttt{t} (or rather \texttt{x}). 
The \texttt{rk4\_step} function looks as follows:
\lstinputlisting[linerange={11-60}]{Homework09_Lorenz-Attractor_Gross-Boelting_Vogel_Willenberg.py}

The only thing that is left to get the results is to plot our values:
\lstinputlisting[linerange={78-103}]{Homework09_Lorenz-Attractor_Gross-Boelting_Vogel_Willenberg.py}


\begin{figure}[t!]
	\centering
	\begin{subfigure}[t]{0.49\textwidth}
		\centering
		\includegraphics[width=\textwidth]{figures/3D-Plot_Lorenz-Attractor-1.pdf}
		\caption{$r=\num{0.5}$}
		\label{fig:r=0.5}
	\end{subfigure}
	\begin{subfigure}[t]{0.49\textwidth}
		\centering
		\includegraphics[width=\textwidth]{figures/3D-Plot_Lorenz-Attractor-2.pdf}
		\caption{$r=\num{1.17}$}
		\label{fig:r=1.17}
	\end{subfigure}
	
	\begin{subfigure}[t]{0.49\textwidth}
		\centering
		\includegraphics[width=\textwidth]{figures/3D-Plot_Lorenz-Attractor-3.pdf}
		\caption{$r=\num{1.3456}$}
		\label{fig:r=1.3456}
	\end{subfigure}
	\begin{subfigure}[t]{0.49\textwidth}
		\centering
		\includegraphics[width=\textwidth]{figures/3D-Plot_Lorenz-Attractor-4.pdf}
		\caption{$r=\num{25.0}$}
		\label{fig:r=25.0}
	\end{subfigure}
	
	\begin{subfigure}[t]{0.49\textwidth}
		\centering
		\includegraphics[width=\textwidth]{figures/3D-Plot_Lorenz-Attractor-5.pdf}
		\caption{$r=\num{29.0}$}
		\label{fig:r=29.0}
	\end{subfigure}
	\caption{Lorenz attractor for different values of $r$. The green marked points are the initial values and the red marked points are the fixed points.}
	\label{fig:Lorenz-attractor}
\end{figure}


\begin{description}
	\item[For $r=0.5$ (see Fig. \ref{fig:r=0.5}):] It is important to note here that our initial conditions were set to $(1\,,\,1\,,\,1)$ in the case that $r<1$. That means that our initial conditons are always real. We can see that our imaginary partice begins at its the beginning point $(1\,,\,1\,,\,1)$ and directly moves towards our fixpoint at $(0\,,\,0\,,\,0)$ and stays there. If we tweak the initial values such that the initial state is allways near our fixed point we will see the same behaviour. As the distance of the initial conditions from the fixed point start to increase we will see that the graph begins to spiral. As soon as the distance becomes too big we see that the graph will stay in its starting point. If we set the initial point to be in our fixed point, wee will see that the particle doesnt moove as well. If we take a look at the real part of the Eigenvalues we can see that they stay negative. That means that our fixed point is stable.
	\item[For $r=1.17$ (see Fig. \ref{fig:r=1.17}):] Note that our starting position from here on is set around our other fixed point at $(\pm a_0\,,\,\pm a_0\,,\,r-1)$. We can observe the same behaviour as in the last plot. All the real parts of the Eigenvalues are negative and therefore we have get a stable fixed point.
\end{description}


%\begin{description}
%	\item[Task:]  Determine the sequence $z_k$ for $r=26.5$, where $z_k$ is a local maximum in $z$
%	on the solution curve after $k$ periods. Plot $z_{k+1}$ as a function of $z_k$.
%	When sufficient points are there, connect the points. The resulting function $z_{k+1}=f(z_k)$ has an intersection with the diagonal $z_{k+1}=z_k$. It is a fixed point of the function $f(z_k)$. Is the slope $m$ of this function $>1$, $<-1$ or between $-1$ and $+1$?
%	Notice: The theory of discrete maps says that there is no periodic solution if $|m|>1$. 
%	So, in such a case we can deduce that this solution of the Lorenz system is not periodic.
%\end{description}
\end{document}

